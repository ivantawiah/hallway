{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Article Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css" rel="stylesheet">
    <style>
        /* Global Styles */
        * {
    box-sizing: border-box;
}

        body {
            margin: 0;
            padding-top: 40px;
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f9f9f9;
        }

        .container {
            width: 90%;
            max-width: 800px;
            margin: 0 auto;
        }

        /* Header Section */
        .header {
            position: relative;
            margin: 0 auto;
            max-width: 800px;
            width: 90%;
            max-height: 400px;
            border-radius: 10px;
            overflow: hidden;
        }

        .header img {
            width: 100%;
            object-fit: cover;
            height: 400px;
        }

        .header-title {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            background: rgba(0, 0, 0, 0.6);
            padding: 15px 25px;
            border-radius: 8px;
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
        }

        /* Article Section */
        .article-content {
            padding: 20px 0;
        }

        .article-content h1 {
            font-size: 2.2rem;
            color: #604007;
            
        }

        .article-content p {
            font-size: 12pt;
            margin: 15px 0;
            color: #535a65;
        }

        .date {
            margin-top: 10px;
            color: #888;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        /* Audio Player and Actions */
        .actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }

        .actions-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .actions-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .actions-left button {
            border: none;
            background: #604007;
            color: #fff;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .actions-left button:hover {
            background: #9c6d1a;
            
        }

        .actions-left span {
            font-size: 1rem;
            font-weight: 500;
            color: #333;
        }

        .actions-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .actions-right a {
            text-decoration: none;
            color: #604007;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .actions-right a:hover {
            color: #9c6d1a;
        }

        .progress-bar-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .progress {
            flex: 1;
        }

        .minutes-read {
            font-size: 0.9rem;
            color: #555;
        }

        /* Footer Section */
        .footer {
            text-align: center;
            margin: 40px 0;
            font-size: 0.9rem;
            color: #888;
        }

        @media (max-width: 468px) {
            .header img {
                height: 300px;
            }

            .actions-left button {
            border: none;
            background: #604007;
            color: #fff;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            font-size: 0.7rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            }

            .actions-right {
                display: flex;
                align-items: center;
                gap: 15px;
            }

            .actions-right a {
                text-decoration: none;
                color: #604007;
                font-size: 1.2rem;
                display: flex;
                align-items: center;
                gap: 5px;
            }

            .actions-right span {
                display: none;
            }


            .header-title {
                font-size: 1.5rem;
                padding: 10px 15px;
            }

            
        }

        /* Responsive Design */
        @media (max-width: 868px) {
            .header img {
                height: 300px;
            }

            .header-title {
                font-size: 1.09rem;
                padding: 10px 15px;
            }

            .article-content h1 {
                font-size: 1.8rem;
                color: #604007;
            }
        }

        /* PDF-Specific Overrides */
@media print {
    body {
        width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
    }

    .header-title {
        position: static !important;
        transform: none !important;
        background: transparent !important;
        color: #000 !important;
        padding: 0 !important;
        text-align: center;
        margin: 20px 0;
    }

    .header img {
        display: none;
    }

    .actions, .footer button, .bi {
        display: none !important;
    }

    .article-content {
        padding: 0 !important;
    }

    .page-break {
        page-break-before: always;
    }
}

/* Explicit Widths for PDF Elements */
.pdf-container {
    width: 210mm; /* A4 width */
    min-height: 297mm; /* A4 height */
    margin: 0 auto;
    padding: 20px;
    background: white;
}

/* Force Visibility for PDF */
.force-visible {
    opacity: 1 !important;
    visibility: visible !important;
    position: static !important;
}
    </style>
</head>
<body id="body">
    <!-- Header Section -->
    <div class="header">
        <img src="{% static 'assets/img/gallery/mall.png' %}" alt="Header Image">
        <div class="header-title">{{pk}}</div>
    </div>

    <!-- Article Content -->
    <div class="container">
        <div class="date">Published: January 25, 2025, at 10:00 AM</div>
        <div class="actions">
            <div class="actions-top">
                <!-- Audio Player -->
                <div class="actions-left">
                    <button id="playPauseBtn"><i class="bi bi-play-fill"></i></button>
                    <span>Listen to this article</span>
                </div>
                <!-- Share and Bookmark Buttons -->
                <div class="actions-right">
                    <a href="#" id="shareButton"><i class="bi bi-share"></i><span> Share</span></a>
                    <a href="#" id="bookmarkButton"><i class="bi bi-bookmark"></i><span> Bookmark</span></a>
                </div>
            </div>
            <!-- Progress Bar -->
            <div class="progress-bar-container">
                <div class="progress">
                    <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <span class="minutes-read" id="minutesRead">0 min read</span>
            </div>
        </div>
        <div class="article-content">
            <h1>Why People Visit Malls: Exploring Quality Products and Unique Offerings</h1>
            <p>Malls have evolved into much more than just shopping centers; they are vibrant social hubs that cater to a wide array of interests and needs. From the moment you step inside, the atmosphere buzzes with energy, offering a blend of retail therapy, culinary delights, and entertainment options. As people seek experiences that go beyond mere shopping, malls have adapted to provide a multifaceted environment where visitors can enjoy quality products while connecting with friends and family.</p>
            <p>The allure of malls lies in their ability to offer something for everyone. Whether itâ€™s the thrill of discovering the latest fashion trends, indulging in gourmet dining, or enjoying a movie with loved ones, malls create an inviting space that encourages exploration and interaction. In this blog post, we will delve deeper into the primary motivations that drive people to visit malls, highlighting the quality products and unique offerings that enhance the overall experience.</p>
            <h5>1. Diverse Shopping Options</h5>
            <p>One of the main draws of malls is the vast array of stores available. From high-end fashion boutiques to popular chain retailers, malls offer a diverse shopping experience. Shoppers can find everything from clothing and accessories to electronics and home goods, all under one roof. This convenience allows visitors to compare products and prices easily, ensuring they find the best quality items.</p>
            <h5>2. Quality Brands</h5>
            <p>Malls often feature well-known brands that are synonymous with quality. Shoppers are drawn to stores like Apple, Nike, and Sephora, where they can find the latest products backed by brand reputation. The assurance of quality often makes the shopping experience more satisfying, as consumers feel confident in their purchases.</p>
            <h5>3. Unique Dining Experiences</h5>
            <p>Beyond shopping, malls offer a culinary adventure with a range of dining options. Food courts typically feature local favorites alongside international cuisines, allowing visitors to indulge in delicious meals. Many malls also house popular restaurants and cafes, making it easy to enjoy a meal or snack while shopping.</p>
            <h5>4. Entertainment and Events</h5>
            <p>Malls are not just about shopping; they often serve as entertainment venues. Many feature cinemas, arcades, and live performance spaces, allowing visitors to spend an entire day enjoying various activities. Seasonal events, such as holiday markets or fashion shows, also attract crowds and create a lively atmosphere.</p>
            <h5>5. Social Interaction</h5>
            <p>Malls serve as a social gathering place, where friends and families come together to enjoy a day out. The combination of shopping, dining, and entertainment creates a vibrant environment that encourages social interaction. Whether itâ€™s catching up over coffee or shopping for gifts together, the mall experience fosters connections among visitors.</p>
            <br>
            <hr>
            <br>
            <h4>Conclusion</h4>
            <p>In summary, malls remain popular destinations for a variety of reasons, from diverse shopping options and quality brands to unique dining experiences and entertainment. The combination of these offerings creates a vibrant and engaging environment that appeals to shoppers of all ages. Whether you're looking for the latest fashion trends or a place to spend time with friends, malls continue to be a go-to destination for many.</p>
            <br>
            <hr>
            <br>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        &copy; 2025 Hallway | Articles <br>
        <br>
        <button id="download-pdf">Download this Article</button>
    </div>

    <!-- JavaScript for Audio -->
    <script>
        const playPauseBtn = document.getElementById("playPauseBtn");
        const progressBar = document.getElementById("progressBar");
        const minutesRead = document.getElementById("minutesRead");
        const articleText = document.querySelector(".article-content").innerText;

        const synth = window.speechSynthesis;
        let isPlaying = false;
        let utterance;
        let duration = 0;

        playPauseBtn.addEventListener("click", () => {
            if (!isPlaying) {
                utterance = new SpeechSynthesisUtterance(articleText);
                synth.speak(utterance);
                duration = Math.ceil(articleText.split(" ").length / 150); // Estimate time: 150 words/min
                playPauseBtn.innerHTML = '<i class="bi bi-pause-fill"></i>';
                isPlaying = true;

                let currentTime = 0;
                utterance.onboundary = () => {
                    currentTime++;
                    const progress = (currentTime / duration) * 100;
                    progressBar.style.width = `${progress}%`;
                    minutesRead.textContent = `${Math.min(currentTime, duration)} min read`;
                };

                utterance.onend = () => {
                    playPauseBtn.innerHTML = '<i class="bi bi-play-fill"></i>';
                    isPlaying = false;
                };
            } else {
                synth.cancel();
                playPauseBtn.innerHTML = '<i class="bi bi-play-fill"></i>';
                progressBar.style.width = "0%";
                minutesRead.textContent = `${Math.min(currentTime, duration)} min read`;
                isPlaying = false;
            }
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script>
        document.getElementById('download-pdf').addEventListener('click', function () {
            // Create a clone of the content
            const element = document.getElementById('body').cloneNode(true);
            
            // Remove unwanted elements
            element.querySelectorAll('.actions, #download-pdf, .footer button').forEach(el => el.remove());
            
            // Add PDF-specific classes
            element.querySelector('.header-title').classList.add('force-visible');
            element.querySelector('.container').classList.add('pdf-container');
    
            // Generate PDF with proper settings
            html2pdf().set({
                margin: [7, 1, 7, 1],
                filename: 'article.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { 
                    scale: 2, 
                    logging: true,
                    useCORS: true,
                    scrollX: 0,
                    scrollY: 0
                },
                jsPDF: { 
                    unit: 'mm', 
                    format: 'a4', 
                    orientation: 'portrait' 
                }
            }).from(element).save();
        });
    </script>
</body>
</html>
